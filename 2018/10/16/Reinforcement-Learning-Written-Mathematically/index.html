<html>
  <head>
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



<link href="/lib/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="/css/html.css" rel="stylesheet" type="text/css">
<link href="/css/header.css" rel="stylesheet" type="text/css">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">



<meta name="description" content="Reinforcement Learning: The mathematical definition of the problem">
<meta name="keywords" content="katie clark, reinforcement learning, mathematics, definition">

<title>Reinforcement Learning Written Mathematically | Come with me now on a journey through code and data...</title>


<link href="/css/post.css" rel="stylesheet" type="text/css">
<link href="/css/notebook.css" rel="stylesheet" type="text/css">

<meta property="og:type" content="article">
<meta property="og:title" content="Reinforcement Learning Written Mathematically">
<meta property="og:url" content="http://hello-klol.github.io/2018/10/16/Reinforcement-Learning-Written-Mathematically/index.html">
<meta property="og:site_name" content="Come with me now on a journey through code and data...">
<meta property="og:description" content="Reinforcement Learning: The mathematical definition of the problem">
<meta property="og:locale" content="English">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$']]}
});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>
    <title>Reinforcement Learning Written Mathematically</title>
  </head>
  <body>
<div class="header">
  <div class="title-bar">
    <span class="site-title">Come with me now on a journey through code and data...</span>
  </div>
  <nav class="site-nav">
    <ul>
      <li class="nav-item">
        <a href="/" rel="section">
          <i class="fa fa-fw fa-home"></i> <br>Home</a>
      </li>
      <li class="nav-item">
        <a href="/about/" rel="section">
          <i class="fa fa-fw fa-child"></i> <br>About</a>
      </li>
      <li class="nav-item">
        <a href="/archives/" rel="section">
          <i class="fa fa-fw fa-book"></i> <br>Blog</a>
      </li>
      <li class="nav-item">
        <a href="https://github.com/hello-klol" rel="external" target="_blank">
          <i class="fa fa-fw fa-github-alt"></i> <br>GitHub</a>
      </li>
      <li class="nav-item">
        <a href="https://twitter.com/_katie_clark_" rel="external" target="_blank">
          <i class="fa fa-fw fa-twitter"></i> <br>Twitter</a>
      </li>
      <li class="nav-item">
        <a href="https://stackoverflow.com/users/1168920/katie" rel="external" target="_blank">
          <i class="fa fa-fw fa-stack-overflow"></i> <br>StackOverflow</a>
      </li>
      <li class="nav-item">
        <a href="/katie-clark-resume.pdf" rel="section"i target="_blank">
          <i class="fa fa-fw fa-user"></i> <br>Resume</a>
      </li>
    </ul>
  </nav>
</div>
<article itemscope itemtype="http://schema.org/Article">
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hello-klol.github.io/">

<span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
  <meta itemprop="name" content="Katie Clark">
  <meta itemprop="description" content="It's a Data Science blog">
  <meta itemprop="image" content="/images/avatar.gif">
</span>

<span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
  <meta itemprop="name" content="Come with me now on a journey through code and data...">
</span>
<span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
  <meta itemprop="name" content="Katie Clark">
  <meta itemprop="description" content="It's a Data Science blog">
  <meta itemprop="image" content="/images/avatar.gif">
</span>
<span>
  <meta itemprop="name" content="Come with me now on a journey through code and data...">
</span>


<header>
  <link itemprop="mainEntityOfPage" href="http://hello-klol.github.io/2018/10/16/Reinforcement-Learning-Written-Mathematically/">
    <h1 class="post-title" itemprop="name headline">Reinforcement Learning Written Mathematically</h1>
  </link>
  <div class="post-meta">
    <span class="post-meta-icon">
      <i class="fa fa-calendar-o"></i>
    </span>
    <span class="post-meta-text">Posted on</span>
    <time title="Created: 2018-10-16 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-16T00:00:00Z">2018-10-16</time>
    <div class="post-description">Reinforcement Learning: The mathematical definition of the problem</div>
  </div>
</header>

    <div class="post-body" itemprop="articleBody">
      <div class="notebook">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="info">In the <a href="/2018/08/23/Reinforcement-Learning-In-Plain-English/" target="_blank">previous post</a> I introduced Reinforcement Learning and gave an overview of how it works in plain English. Next, let&apos;s look at how to write this definition as a mathematical problem.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mathematically-Formalising-the-Problem">Mathematically Formalising the Problem<a class="anchor-link" href="#Mathematically-Formalising-the-Problem">&#xB6;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To solve the problem we need to define the problem! The animated loop shown below can be written using a mathematical formulation known as the Markov decision process (MDP).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/images/reinforcement/reinforcement-loop.gif" alt="The Reinforcement Learning Loop" title="Weeee"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An MDP satisfies the Markov property, which is that the current state completely characterizes the state of the world. Bear with me..</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MDP-Object-Definitions">MDP Object Definitions<a class="anchor-link" href="#MDP-Object-Definitions">&#xB6;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An MDP is defined by tuple of objects, consisting of:</p>
<ul>
<li>$\mathcal{S}$, which is the <em>set of possible states</em>. </li>
<li>$\mathcal{A}$, our <em>set of possible actions</em>.</li>
<li>$\mathcal{R}$, our <em>distribution of our reward</em>, given a state-action pair. So it&apos;s a function mapping from state-action $\mapsto$ reward. </li>
<li>$\mathbb{P}$, which is a <em>transition probability distribution</em> over your next state, that you&apos;re going to transition to given your state-action pair.</li>
<li>$\gamma$, a <em>discount factor</em>, which is basically saying <em>how much we value rewards coming up soon versus later on</em>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MDP-Process">MDP Process<a class="anchor-link" href="#MDP-Process">&#xB6;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>At time step $t=0$, the environment samples the initial state $s_0 \sim p(s_0)$</li>
<li>For $t=0$ until done (terminal state):<ul>
<li>Agent selects an action, $a_t$</li>
<li>Environment samples a reward, $r_t \sim R( . | s_t, a_t)$</li>
<li>Environment samples the next state, $s_{t+1} \sim P( . | s_t, a_t)$</li>
<li>Agent receives the reward, $r_t$, and next state, $s_{t+1}$</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>&#x1F6A8; <strong>New lingo:</strong>
A policy, $\pi$, is a function that specifies what action to take in each state.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So our objective can be redefined as:
Find the optimal policy, $\pi^*$, that maximises the cumulative (discounted) reward.</p>
<p>The term &quot;discounted&quot; is included here as we want to take into account our discount factor, $\gamma$, which balances how we value immediate vs. long term rewards.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This objective can be formulated as:
$$\max\sum\limits_{t \ge 0} \gamma^t r_t$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="What-about-randomness?">What about randomness?<a class="anchor-link" href="#What-about-randomness?">&#xB6;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How do we handle randomness? We have randomness in terms of the initial state that we&apos;re sampling, and in terms of this transistion probability distribution that will give us distributions over next states, and so on.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So we need to maximise the <em>expected</em> sum of rewards.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The optimal policy, $\pi^*$, is the policy which maximises this reward:
$$\pi^* = \arg\max_{\pi}\mathbb{E}\left[\sum\limits_{t \ge 0} \gamma^t r_t|\pi\right]$$ 
with
$$s_0 \sim p(s_0), a_t \sim \pi(\cdot|s_t), s_{t+1} \sim p(\cdot|s_t,a_t)$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="sidenote">Note: $\mathbb{E}$ represents the expected value of a random variable</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can write our optimal policy $\pi^*$ as maximizing the expected sum of future rewards over
policy&apos;s $\Pi$, where</p>
<ul>
<li>initial state, $s_0$, is sampled from our state distribution</li>
<li>action, $a_t$, is sampled from our policy, given the state</li>
<li>next state, $s_{t+1}$, is sampled from our transition probability distributions</li>
</ul>

</div>
</div>
</div>
    </div>
  </div>
    </div>

<footer>
  <div class="post-nav">
    <div class="post-nav-prev post-nav-item">
      <a href="/2018/10/15/My-Python-Setup-And-More/" rel="prev" title="My Python Setup and More">
        <i class="fa fa-chevron-left"></i><div class="post-nav-item">My Python Setup and More</div>
      </a>
    </div>
    <span class="post-nav-divider"></span>
    <div class="post-nav-next post-nav-item">
      <a href="/2018/10/17/Reinforcement-Learning-Finding-The-Optimal-Policy/" rel="next" title="Reinforcement Learning Finding The Optimal Policy">
        <div class="post-nav-item">Reinforcement Learning Finding The Optimal Policy</div><i class="fa fa-chevron-right"></i>
      </a>
    </div>
  </div>
</footer>
  </div>
</article>
  </body>
</html>
